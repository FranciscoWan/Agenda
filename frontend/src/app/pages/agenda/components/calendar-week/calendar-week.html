<div class="w-full h-[62dvh] flex flex-col overflow-hidden">

    <!-- Cabeçalho -->
    <div class="flex items-center mb-4">

        <button (click)="previousWeek()"
            class="px-2 py-1 cursor-pointer text-gray-100 hover:scale-110 transition-all duration-200">
            <fa-icon [icon]="faAngleLeft"></fa-icon>
        </button>

        <button (click)="nextWeek()"
            class="px-2 py-1 cursor-pointer text-gray-100 hover:scale-110 transition-all duration-200">
            <fa-icon [icon]="faAngleRight"></fa-icon>
        </button>

        <h2 class="px-6 text-lg font-semibold text-gray-100">
            semana de {{ weekDays()[0] | date:'dd/MM/yyyy' }}
            - {{ weekDays()[6] | date:'dd/MM/yyyy' }}
        </h2>

    </div>

    <!-- Dias da semana -->
    <div class="grid grid-cols-7 text-center text-sm font-semibold text-gray-200 border-b border-indigo-100 pb-2">
        <div>Dom</div>
        <div>Seg</div>
        <div>Ter</div>
        <div>Qua</div>
        <div>Qui</div>
        <div>Sex</div>
        <div>Sáb</div>
    </div>

    <!-- Grid da semana -->
    <div class="grid grid-cols-7 gap-px bg-gray-400 overflow-hidden mt-2">

        @for (day of weekDays(); track day) {

        <div class="bg-[var(--color-black-background)]
            min-h-[48dvh]
            text-sm
            relative
            flex
            flex-col
            overflow-hidden
            min-h-0
            hover:bg-neutral-600
            transition">

            <!-- Número do dia -->
            <span class="absolute top-2 right-2 text-gray-400 text-xs">
                {{ day | date:'dd' }}
            </span>

            <!-- Eventos -->
            <div class="mt-6 flex flex-col space-y-1 custom-scroll min-h-0 flex-1 p-1">
                @for (event of eventsByDay()[day.toDateString()]; track event.id) {
                <div (click)="openEvent(event)"
                    class="text-black text-xs font-bold h-6 px-2 py-1 flex items-center shrink-0 rounded-md truncate hover:scale-104 cursor-pointer"
                    [style.background]="event.cor">
                    {{ event.titulo }}
                </div>
                }

            </div>

        </div>

        }

    </div>

</div>


@if (isModalOpen() && selectedEvent()) {

<!-- Overlay -->
<div class="fixed inset-0 top-0 bg-black/50 flex items-center justify-center z-50" (click)="closeModal()">

    <!-- Card central -->
    <div class="rounded-xl w-[600px] p-6 relative" (click)="$event.stopPropagation()">

        <app-card-next-events 
            [id]="selectedEvent()!.id"
            [titulo]="selectedEvent()!.titulo" 
            [descricao]="selectedEvent()!.descricao"
            [dataInicio]="selectedEvent()!.dataInicio" 
            [dataFim]="selectedEvent()!.dataFim"
            [cor]="selectedEvent()!.cor">
            (deleted)="handleDeleted()">
        </app-card-next-events>

        <button (click)="closeModal()" class="absolute top-2 right-2 text-gray-200 hover:text-gray-500 cursor-pointer">
            ✕
        </button>

    </div>

</div>

}